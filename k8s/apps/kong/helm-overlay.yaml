---
apiVersion: source.toolkit.fluxcd.io/v1beta1
kind: HelmRepository
metadata:
  name: repo
spec:
  url: https://charts.konghq.com
---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: release
spec:
  chart:
    spec:
      chart: kong
      version: 2.26.5
  values:
    env:
      database: postgres
      customEnv:
        pg_host: "postgres-release-postgresql.databases.svc.cluster.local"
        pg_port: 5432
        pg_user: kong
        pg_password:
          valueFrom:
            secretKeyRef:
              key: kong-secret
              name: pg-password
        pg_database: kong
