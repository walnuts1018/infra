apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: mega
  namespace: samba
spec:
  data:
    - remoteRef:
        key: samba
        property: longhorn-encryption-key
      secretKey: CRYPTO_KEY_VALUE
  refreshInterval: 1m
  secretStoreRef:
    kind: ClusterSecretStore
    name: onepassword
  target:
    name: mega
    template:
      data:
        CRYPTO_KEY_CIPHER: aes-xts-plain64
        CRYPTO_KEY_HASH: sha256
        CRYPTO_KEY_PROVIDER: secret
        CRYPTO_KEY_SIZE: "256"
        CRYPTO_KEY_VALUE: '{{ .CRYPTO_KEY_VALUE }}'
        CRYPTO_PBKDF: argon2i
      engineVersion: v2
      type: Opaque
