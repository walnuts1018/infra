apiVersion: apps/v1
kind: Deployment
metadata:
  name: walnuts-dev
  labels:
    app: walnuts-dev
spec:
  replicas: 1
  selector:
    matchLabels:
      app: walnuts-dev
  template:
    metadata:
      labels:
        app: walnuts-dev
    spec:
      containers:
        - name: walnuts-dev
          image: ghcr.io/walnuts1018/walnuts.dev:3d7331e9740253ba2332bd41db1a433b0261dcef-205 # {"$imagepolicy": "default:walnuts-dev"}
          imagePullPolicy: IfNotPresent
          ports:
            - containerPort: 3000
          resources:
            limits: {}
            requests: {}
          env:
            - name: NEXT_PUBLIC_GA_ID
              value: G-NB6F68ZQ9P
          volumeMounts:
            - name: walnutsdev-resolv-conf
              mountPath: /etc/resolv.conf
              readOnly: true
  volumes:
    - name: walnutsdev-resolv-conf
      hostPath:
        path: /etc/resolv.conf
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: walnutsdev-resolv-conf
data:
  resolv.conf: |
    search default.svc.cluster.local svc.cluster.local cluster.local walnuts.dev
    nameserver 10.96.0.10
    options ndots:5
