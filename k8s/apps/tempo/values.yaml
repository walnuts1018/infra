tempo:
  resources:
    requests:
      cpu: 5m
      memory: 256Mi
    limits:
      memory: 4Gi
  storage:
    trace:
      backend: s3
      s3:
        bucket: tempo
        endpoint: "minio.minio.svc.cluster.local"
        insecure: true
  extraArgs:
    "-config.expand-env": true
  extraEnv:
  - name: AWS_WEB_IDENTITY_TOKEN_FILE
    value: /var/run/secrets/sts.min.io/serviceaccount/token
  - name: AWS_ENDPOINT_URL_STS
    value: https://sts.minio-operator.svc.cluster.local:4223/sts/minio
  - name: AWS_ENDPOINT_URL_S3
    value: http://minio.minio.svc.cluster.local
  - name: AWS_REGION
    value: ap-northeast-1
  - name: AWS_ROLE_ARN
    value: arn:aws:iam::dummy:role/tempo-minio-role
  extraVolumeMounts:
  - name: minio-sts-token
    mountPath: /var/run/secrets/sts.min.io/serviceaccount
    readOnly: true
  - name: local-ca-bundle
    mountPath: /etc/ssl/certs/trust-bundle.pem
    subPath: trust-bundle.pem
    readOnly: true

extraVolumes:
- name: minio-sts-token
  projected:
    sources:
    - serviceAccountToken:
        audience: sts.min.io
        expirationSeconds: 3600
        path: token
- name: local-ca-bundle
  configMap:
    name: local-ca-bundle
